# 0.2 UX定義

## 文書情報
- **作成日**: 2025-10-20
- **対象**: Tokyo Friends iOS App (仮称)
- **バージョン**: v1.0 (MVP)
- **想定プラットフォーム**: iOS 16以上（推奨：iOS 17+）

---

## 1. 目的

本文書は、ユーザーがアプリと接触するすべてのタッチポイントにおいて**一貫した体験価値**を提供するための原則・フロー・ガードレールを定義します。

### 狙い
- 「友達づくり」という健全な目的を、すべての導線・文言・遷移で強化する
- 不安・プレッシャーを軽減し、安心して参加できる体験を設計する
- ビジネス成功指標（相互同意率・継続率）と体験品質の両立を図る

【MAT参照：1. プロダクト概要 / 3. 体験原則】

---

## 2. UX原則（体験ガードレール）

### 2.1 コア原則

#### P1: 友達づくりのコンテキストを明示する
**背景**: 恋愛・デーティング文脈の誤解を避け、健全なコミュニティ形成を促進する

**実装ガイドライン**:
- UI文言から「出会い」「恋人」「デート」を排除
- 代替: 「友達づくり」「同じ趣味の仲間」「コミュニティで見つける」
- プロフィール例文テンプレは中立的な内容（例: 「週末カフェ巡りが好きです」）
- オンボーディングで「友達づくりアプリ」と明示

【MAT参照：3. 体験原則 / 12. 文言ポリシー / 21. 付録：UIコピー指針】

#### P2: 顔出しを任意にする
**背景**: 容姿へのプレッシャーを軽減し、多様な参加者を受け入れる

**実装ガイドライン**:
- 写真0枚でもカード生成・探索可能
- 写真未登録時のUI: 「写真は任意です。趣味や興味で繋がりましょう」
- 興味タグ・自己紹介を主要判断材料として強調
- プロフィール編集画面で「顔出しなしでもOK」と明示

【MAT参照：3. 体験原則 / 4.2. オンボーディング／プロフィール】

#### P3: 安全操作を1タップで提供する
**背景**: 不快な体験から即座に離脱できることで、安心感を担保

**実装ガイドライン**:
- ブロック／通報／非表示を常に1タップで実行可能
- カード詳細画面（PG-31）の右上に「…」メニュー常設
- 実行後の取り消しは設定＞安全センターで管理
- 通報時は理由選択必須（スパム／なりすまし／ハラスメント／不適切画像／未成年疑い／その他）

【MAT参照：3. 体験原則 / 4.6. 安全 / ページ定義 PG-31 / PG-62】

#### P4: 相互同意のない個人情報露出を禁止する
**背景**: プライバシー保護とInstagram規約順守

**実装ガイドライン**:
- IGハンドルは相互同意成立まで完全非表示（サーバー暗号化保存）
- 片方がブロックした場合、ハンドル表示無効化
- マッチ画面（PG-32）でのみIGハンドル可視化
- 外部遷移前に「Instagramを開きます。よろしいですか？」確認ダイアログ必須

【MAT参照：3. 体験原則 / 4.5. マッチング / 7. Instagram連携ポリシー】

---

### 2.2 体験階層（優先順位）

体験価値を以下の階層で優先順位付け:

1. **安全性**: 18歳未満排除、通報対応、ブロック即時反映
2. **透明性**: データ利用目的の明示、削除・エクスポート導線
3. **発見性**: コミュニティ参加 → 友達候補の探索
4. **成功体験**: マッチ成立 → IG連携のスムーズな遷移
5. **継続性**: 連続日数ピル、定期的なコミュニティおすすめ

【MAT参照：1.2. 主要価値 / 1.3. 成功指標】

---

## 3. ユーザージャーニーマップ

### 3.1 初回ユーザージャーニー（新規登録 → 初マッチまで）

#### フェーズ1: 認知・興味（アプリストア外）
- **接点**: 友人紹介、SNS、大学内ポスター
- **感情**: 「友達ほしいけど、顔出し必須なら嫌だな」
- **期待**: 安全で気軽に始められそう

#### フェーズ2: ダウンロード・登録（PG-01〜03）
- **接点**: スプラッシュ → ログイン → 年齢確認
- **体験**:
  - 「18歳以上のみ」で安心感
  - 電話番号 or Apple（選択肢あり）で心理的ハードル軽減
  - 年齢確認で「健全運営」の印象
- **感情**: 「ちゃんと管理されてそう」「怪しくなさそう」
- **離脱リスク**: SMS届かない、年齢確認でつまずく
- **対策**: 再送ボタン60sクールダウン、エラーメッセージ明確化

【MAT参照：4.1. 会員登録・認証 / ページ定義 PG-01〜03】

#### フェーズ3: オンボーディング（PG-05〜09）
- **接点**: 基本属性 → 興味タグ → 写真 → IGハンドル
- **体験**:
  - ステッパーで進捗可視化（1/4 → 2/4 → ...）
  - 興味タグ選択で「自分と似た人がいそう」と期待
  - 写真は任意（「スキップ」ボタン明示）
  - IGハンドル登録時に「相互同意まで非表示」と説明
- **感情**: 「簡単だった」「興味タグ選ぶの楽しい」
- **離脱リスク**: 入力項目が多すぎる、駅検索が面倒
- **対策**: 必須項目を最小限に、駅検索は前方一致で候補10件以内

【MAT参照：4.2. オンボーディング／プロフィール / ページ定義 PG-05〜09】

#### フェーズ4: コミュニティ参加（PG-20〜21）
- **接点**: 完了画面 → 「コミュニティに参加」CTA → 一覧
- **体験**:
  - 「新宿×カフェ」「新宿×サウナ」など具体的
  - 参加人数で賑わい感
  - 1コミュニティ参加 → 「探索を始める」導線
- **感情**: 「自分の興味に合うのがある」「参加しやすい」
- **離脱リスク**: コミュニティが少ない、魅力的でない
- **対策**: 新宿内でコミュニティ密度を作る施策（学内・店舗連携）

【MAT参照：4.3. コミュニティ / ページ定義 PG-20〜21】

#### フェーズ5: 探索・スワイプ（PG-30）
- **接点**: ホームタブ or 探索タブ
- **体験**:
  - カード1枚ずつで集中しやすい
  - 興味タグ一致度が高い順に表示
  - 左スワイプ（スキップ）/ 右スワイプ（興味あり）が直感的
  - レート制限で「連打しすぎ」を防止
- **感情**: 「共通点多い人いるな」「操作が気持ちいい」
- **離脱リスク**: カード在庫切れ、全員似たような人
- **対策**: 在庫切れ時は「コミュニティ追加」提案、多様性確保のランキング調整

【MAT参照：4.4. カード探索 / ページ定義 PG-30】

#### フェーズ6: マッチ成立（PG-32）
- **接点**: 相互同意後に半モーダル
- **体験**:
  - 成功アニメで喜び増幅
  - 相手のIGハンドル表示
  - 「Instagramを開く」ボタンで即連携
  - 外部遷移確認ダイアログで安心感
- **感情**: 「やった！」「すぐ繋がれる」
- **離脱リスク**: Instagram未インストール、ハンドル間違い
- **対策**: ブラウザフォールバック、コピーボタン設置

【MAT参照：4.5. マッチング / ページ定義 PG-32】

---

### 3.2 継続ユーザージャーニー（2回目以降の訪問）

#### フェーズ1: 再訪問（PG-10 ホーム）
- **接点**: アプリ起動 → ホーム画面
- **体験**:
  - ヒーロー挨拶「こんにちは　午後も◯◯を楽しみましょう」
  - 連続日数ピル「🔥7日連続」で継続モチベーション
  - 速報カード（新規コミュニティ・おすすめ友達候補）
  - おすすめカード（横スクロール）で新鮮さ
- **感情**: 「また来たくなる」「毎日の習慣にできそう」
- **離脱リスク**: 新鮮味がない、マッチしない
- **対策**: 定期的なコミュニティ追加、ランキング刷新

【MAT参照：ページ定義 PG-10】

#### フェーズ2: マッチ管理（PG-33）
- **接点**: マッチタブ
- **体験**:
  - 既にマッチした相手一覧
  - 「Instagramを開く」ボタンで再連携
  - ブロック済みはグレーアウト、右スワイプで解除
- **感情**: 「管理しやすい」「整理されてる」
- **離脱リスク**: マッチ0件で寂しい
- **対策**: 空状態で「探索を始める」CTA

【MAT参照：ページ定義 PG-33】

#### フェーズ3: プロフィール更新（PG-61）
- **接点**: 設定 → プロフィール編集
- **体験**:
  - セクション分割（自己紹介 / 興味タグ / 写真 / IGハンドル）で見やすい
  - 写真の並び替えは長押しドラッグ
  - 保存成功トースト
- **感情**: 「簡単に更新できた」
- **離脱リスク**: 保存失敗
- **対策**: バリデーションエラーを明確に表示

【MAT参照：ページ定義 PG-61】

---

## 4. 主要フロー定義

### 4.1 会員登録フロー（PG-01 → PG-09）

```
PG-01 スプラッシュ
  ↓ セッション確認（初回）
PG-02 ログイン
  ├─ 電話番号 → SMS認証
  └─ Appleでサインイン
  ↓ 規約同意チェック
PG-03 年齢確認
  ├─ 生年月日入力
  └─ セルフィー年齢推定
  ↓ 18歳以上のみ通過
PG-04 権限リクエスト
  ├─ 通知許可（理由説明 → OS許諾）
  └─ 写真許可（理由説明 → OS許諾）
  ↓
PG-05 基本属性
  ├─ 居住区・最寄駅
  ├─ 属性（学生/社会人）
  └─ 学校名/勤務形態
  ↓
PG-06 興味タグ
  └─ 3〜10個選択
  ↓
PG-07 写真（任意）
  └─ 最大5枚、EXIF除去
  ↓
PG-08 IGハンドル（任意）
  └─ 説明テキスト付き
  ↓
PG-09 完了
  └─ 「コミュニティに参加」CTA
  ↓
PG-10 ホーム
```

**平均所要時間**: 3〜5分（目標：中央値4分以内）

**離脱率許容値**: 各ステップ<5%、全体<20%

【MAT参照：4.1 / 4.2 / ページ定義 PG-01〜09】

---

### 4.2 探索・マッチフロー（PG-30 → PG-32）

```
PG-30 探索（スワイプ）
  ├─ 左スワイプ（スキップ）→ 次カードへ
  └─ 右スワイプ（興味あり）
      ├─ 片側のみ → 待機状態
      └─ 相互同意 → マッチ成立
          ↓
PG-32 マッチ成立シート
  ├─ IGハンドル表示
  ├─ 「Instagramを開く」ボタン
  │   └─ 外部遷移確認ダイアログ
  │       └─ Instagram起動（深いリンク）
  └─ 「あとで」→ マッチ一覧（PG-33）へ保存
```

**成功指標**:
- 相互同意率: 15〜25%（業界標準）
- IGハンドル表示 → 深いリンクタップ率: 70%以上
- マッチ成立 → 初回タップまでの中央値: 30秒以内

【MAT参照：1.3. 成功指標 / 4.4 / 4.5 / ページ定義 PG-30 / PG-32】

---

### 4.3 安全操作フロー（ブロック・通報）

```
PG-31 プロフィール詳細（他者）
  └─ 右上「…」メニュー
      ├─ ブロック
      │   └─ 確認ダイアログ
      │       └─ 即時不可視化（カード/マッチ/通知）
      ├─ 通報
      │   └─ 理由選択（必須）
      │       ├─ スパム
      │       ├─ なりすまし
      │       ├─ ハラスメント
      │       ├─ 不適切画像
      │       ├─ 未成年疑い
      │       └─ その他
      │   └─ 送信成功トースト
      └─ 非表示
          └─ 検索候補から除外（ブロックより軽微）
```

**受け入れ基準**:
- ブロック実行 → 1秒以内に不可視化
- 通報送信 → 3秒以内にトースト表示
- 取り消しは設定＞安全センター（PG-62）で可能

【MAT参照：4.6. 安全 / ページ定義 PG-31 / PG-62】

---

## 5. マイクロインタラクション設計

### 5.1 スワイプカードのフィードバック

**タッチ開始**:
- カードが指に追従（水平移動 + わずかな角度回転）
- 左右移動に応じて背景色ヒント
  - 左 → 薄い赤（スキップ）
  - 右 → 薄い緑（興味あり）

**スワイプ中**:
- 閾値（80pt）を超えると色が濃くなる
- ハプティクス: `impactLight`（閾値到達時）

**スワイプ完了**:
- 閾値超過 → スプリングアニメで画面外へ飛び出し（damping 0.85）
- 閾値未満 → スプリングで元位置へ戻る
- 次カードがスライドイン（下から上へ、0.3s）

【MAT参照：デザイン定義 5. インタラクション / ページ定義 PG-30】

---

### 5.2 マッチ成立の喜び演出

**シーケンス**:
1. 相互同意検出（サーバー側）
2. プッシュ通知「マッチが成立しました」
3. 画面遷移（PG-30 → PG-32）
4. 半モーダルがスライドイン（下から上、0.4s）
5. 成功アニメ:
   - タイトルテキストがスケール 1.0 → 1.1 → 1.0（0.5s）
   - ハプティクス: `notificationSuccess`
6. IGハンドルがフェードイン（0.2s遅延）

**期待される感情**:
- 「やった！」（達成感）
- 「すぐ繋がれる」（即時性）

【MAT参照：デザイン定義 4.6 / 5. / ページ定義 PG-32】

---

### 5.3 エラー時の優しい誘導

**パターンA: 軽微なエラー（通信失敗等）**
- 画面上部にバナー（`systemRed` 10%背景）
- メッセージ: 「読み込みに失敗しました」
- 再試行ボタン（タップ → 再リクエスト）
- 自動非表示: 5秒後

**パターンB: 致命的エラー（サーバー停止等）**
- フル画面表示
- アイコン: `exclamationmark.triangle`
- タイトル: 「エラーが発生しました」
- 説明: 「しばらくしてから再度お試しください」
- 再試行ボタン

**パターンC: オフライン**
- 画面上部にバナー（`systemGray` 10%背景）
- メッセージ: 「インターネット接続を確認してください」
- キャッシュデータをグレーアウトで表示
- 回線復帰 → 自動的にキュー送信

【MAT参照：15. エラー/オフライン設計 / デザイン定義 7. 状態設計 / ページ定義 PG-90】

---

## 6. 文言・トーン設計

### 6.1 基本トーン
- **丁寧だがフレンドリー**: 「しましょう」「できます」を基本
- **押し付けない**: 「〜してください」より「〜してみませんか？」
- **健全性強調**: 「友達」「仲間」「コミュニティ」を多用

### 6.2 シーン別コピー例

| シーン | コピー例 | 意図 |
|---|---|---|
| ホーム見出し | 「新宿で、同じ趣味の友達を見つけよう」 | 地域×興味の軸を明示 |
| マッチ完了 | 「マッチしました！Instagramでつながりますか？」 | 成功体験 + 次アクション提示 |
| 年齢制限 | 「本サービスは18歳以上が対象です」 | 法令遵守の透明性 |
| 外部遷移確認 | 「Instagramを開きます。よろしいですか？」 | ユーザー同意の尊重 |
| 通報導線 | 「不快・不適切な内容を見つけたら、通報をお願いします」 | 安全性の協力要請 |
| 空状態（マッチ0件） | 「まだマッチがありません。探索を始めてみましょう」 | ポジティブな次アクション |
| 空状態（カード在庫切れ） | 「新しいコミュニティに参加すると、友達候補が増えます」 | 解決策の提示 |

【MAT参照：12. 文言ポリシー / 21. 付録：UIコピー指針】

---

## 7. アクセシビリティ体験

### 7.1 VoiceOverユーザー向け

**探索カード（PG-30）**:
- グループ化: 1カード = 1要素として読み上げ
- ラベル例: 「田中太郎、20〜22歳、学生、居住区: 新宿、興味: カフェ・サウナ・写真。自己紹介: 週末カフェ巡りが好きです」
- ヒント: 「左スワイプでスキップ、右スワイプで興味ありを送信します。ダブルタップで詳細を開きます」

**マッチ画面（PG-32）**:
- フォーカス順: タイトル → 説明 → IGハンドル → 主ボタン → 副ボタン
- ラベル: 「Instagramを開く、ボタン。外部アプリに移動します」

【MAT参照：13. アクセシビリティ / デザイン定義 6. / ページ定義 付録B】

---

### 7.2 Dynamic Type対応

**拡大時（最大サイズ）**:
- タイトル・本文は行数増加OK
- 主要CTAは2行まで（3行目以降は省略記号）
- カードの高さは可変（最大: 画面高さの80%）

**縮小時（最小サイズ）**:
- レイアウト崩れなし
- タップ領域は依然44×44pt以上

【MAT参照：13. アクセシビリティ / デザイン定義 6.2】

---

## 8. 計測・ログ（UX観点）

### 8.1 体験品質指標

**初回ユーザー**:
- オンボーディング完了率: 目標80%以上
- 初回セッション → 初コミュニティ参加: 中央値3分以内
- 初回セッション → 初スワイプ: 中央値5分以内
- 初回セッション → 初マッチ: 中央値24h以内（理想: 1h以内）

**継続ユーザー**:
- 7日継続率: 目標40%以上
- 30日継続率: 目標20%以上
- 週間平均セッション数: 目標3回以上
- 連続日数: 目標中央値5日

**安全指標**:
- 通報率: <1%（健全性）
- ブロック率: <5%
- 通報対応SLA: 48時間以内

【MAT参照：1.3. 成功指標 / 14. 分析/ログ / 18. 運用/モデレーション】

---

### 8.2 離脱ポイント計測

**高リスク離脱ポイント**:
1. PG-03（年齢確認）: 18歳未満の離脱は想定内
2. PG-06（興味タグ）: 選択肢が魅力的でない可能性
3. PG-30（探索）: カード在庫切れ、興味ない相手ばかり
4. PG-32（マッチ後）: Instagram未インストール、ハンドル間違い

**離脱率目標**:
- 各ステップ: <5%
- 全体（PG-01 → PG-10）: <20%

【MAT参照：ページ定義全般 / 14. 分析/ログ】

---

## 9. 受け入れ基準（AC）

### 9.1 体験フロー
- [ ] 新規登録 → ホーム到達まで中央値4分以内（実測）
- [ ] マッチ成立 → IGハンドルタップまで中央値30秒以内
- [ ] ブロック実行 → 1秒以内に不可視化

### 9.2 文言・トーン
- [ ] すべての画面で「出会い」「恋人」「デート」が排除されている
- [ ] エラーメッセージが日本語で具体的（原因・対処法）
- [ ] 確認ダイアログが押し付けがましくない

### 9.3 アクセシビリティ
- [ ] VoiceOverで全フローが操作可能（実機検証）
- [ ] Dynamic Type最大時も主要CTAが折り返さない
- [ ] Reduce Motion有効時にパララックス無効化

### 9.4 安全性
- [ ] 18歳未満で登録不可（複数端末・ブラウザで検証）
- [ ] 相互同意なしでIGハンドル非表示（DB直接確認）
- [ ] ブロック後にカード/マッチ/通知すべて不可視（E2Eテスト）

【MAT参照：16. QA/受け入れテスト / デザイン定義 12. 品質ゲート】

---

## 10. Plan-MD 参照マップ

| 本文書セクション | Plan-MD 参照箇所 |
|---|---|
| 1. 目的 | 1. プロダクト概要 |
| 2. UX原則 | 3. 体験原則、12. 文言ポリシー、21. 付録：UIコピー |
| 3. ユーザージャーニー | 4. 主要機能要件、ページ定義全般 |
| 4. 主要フロー | 4.1〜4.6、ページ定義 PG-01〜63 |
| 5. マイクロインタラクション | デザイン定義 5. インタラクション、ページ定義 PG-30/32 |
| 6. 文言・トーン | 12. 文言ポリシー、21. 付録：UIコピー |
| 7. アクセシビリティ体験 | 13. アクセシビリティ、デザイン定義 6 |
| 8. 計測・ログ | 1.3. 成功指標、14. 分析/ログ、18. 運用 |
| 9. 受け入れ基準 | 16. QA/受け入れテスト |

---

## 11. 補足

### 11.1 更新履歴
| 日付 | 変更内容 | 担当 |
|---|---|---|
| 2025-10-20 | 初版作成 | UXデザイン・開発 |

---

**次に読むべき文書**: `0.3_機能定義.md`（機能要件詳細）
