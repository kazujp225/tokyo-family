# 0.5 デザイン定義

## 文書情報
- **作成日**: 2025-10-20
- **対象**: Tokyo Friends iOS App (仮称)
- **バージョン**: v1.0 (MVP)
- **想定プラットフォーム**: iOS 16以上（推奨：iOS 17+）

---

## 1. 目的

本文書は、iOSアプリケーションの**視覚的・表現的な仕様**（色・文字・余白・アニメーション等）を定義し、Apple HIG準拠の自然で一貫性のあるデザインシステムを確立します。

### 狙い
- iOSプラットフォームに「自然に溶け込む」体験を提供
- Figma / SwiftUIでそのまま実装できる具体的なトークン・コンポーネントを規定
- ライト/ダーク、Dynamic Type、アクセシビリティへの対応を組み込む

【MAT参照：デザイン定義全般 / 13. アクセシビリティ】

---

## 2. デザイン原則（Apple哲学の翻訳）

### P1: Content First / Deference（内容優先）
- 余白を多めに取り、装飾より情報階層を明確化
- カードと見出しで視線誘導を3段階（大見出し → セクション見出し → カード）

### P2: Clarity（明瞭さ）
- 1画面＝1主目的。複数アクションは優先順位を明示
- コントラスト・文字サイズ・余白で可読性を最大化

### P3: Depth（奥行き）
- 半透明・ブラー（Material）と柔らかな影を最小限で使用
- モーダルは半モーダルシート（Medium/Large）を基本

### P4: Consistency（一貫性）
- SF Symbols・Semantic Colors・Dynamic Type・標準ナビゲーション要素を優先
- カスタムコンポーネントもiOSの振る舞いを踏襲

### P5: Direct Manipulation（直接操作）
- スワイプ・プル・トゥ・リフレッシュ・リオーダー等の標準ジェスチャを尊重
- タップのフィードバックは即座に視覚・触覚で返す

【MAT参照：デザイン定義 1.デザイン原則】

---

## 3. ビジュアル基調（トークン）

### 3.1 配色（Semantic Colors優先）

**目的**: ライト/ダーク自動対応、コントラスト基準準拠

#### 背景（Background）
| トークン名 | Semantic Color | 用途 |
|---|---|---|
| Bg/Base | `systemBackground` | 画面全体の背景 |
| Bg/Section | `secondarySystemBackground` | セクションブロック背景 |
| Bg/Card | `secondarySystemGroupedBackground` | カード背景 |
| Bg/Elevated | `tertiarySystemBackground` | モーダル・シート背景 |

#### テキスト（Text）
| トークン名 | Semantic Color | 用途 |
|---|---|---|
| Text/Primary | `label` | 主要テキスト（見出し・本文） |
| Text/Secondary | `secondaryLabel` | 補足テキスト（メタ情報） |
| Text/Tertiary | `tertiaryLabel` | さらに軽微なテキスト |
| Text/Link | `link` | リンク・タップ可能テキスト |

#### アクセント（Accent）
| トークン名 | Semantic Color | 用途 | コントラスト |
|---|---|---|---|
| Accent/Primary | `systemBlue`（デフォルト） | 主要CTA・選択状態 | AA Large以上 |
| Accent/Success | `systemGreen` | 成功トースト・マッチ成立 | AA Large |
| Accent/Warning | `systemOrange` | 警告・注意喚起 | AA Large |
| Accent/Danger | `systemRed` | エラー・削除・通報 | AA Large |

※ブランド色を使う場合も、ライト/ダークで十分なコントラストを確保

#### 区切り（Separator）
| トークン名 | Semantic Color | 用途 |
|---|---|---|
| Line/Separator | `separator` | 薄いライン（1px） |
| Line/Opaque | `opaqueSeparator` | 不透明ライン |

#### 材料（Material）
| トークン名 | 用途 |
|---|---|
| `systemMaterial` | ナビゲーションバー・タブバーの背景 |
| `thinMaterial` / `ultraThinMaterial` | モーダル・シートの背景（半透明・ぼかし） |

【MAT参照：デザイン定義 2.1.配色】

---

### 3.2 文字（Dynamic Type準拠）

**目的**: ユーザー設定に追随し、アクセシビリティを担保

#### スタイル一覧
| 用途 | Dynamic Type Style | サイズ（デフォルト） | ウェイト |
|---|---|---|---|
| 大見出し | Large Title | 34pt | Bold |
| セクション見出し | Title 2 | 22pt | Semibold |
| カードタイトル | Headline | 17pt | Semibold |
| 本文 | Body | 17pt | Regular |
| 補足・メタ | Footnote | 13pt | Regular |
| ボタン | Callout | 16pt | Medium |
| キャプション | Caption 1 | 12pt | Regular |

#### 行間・段落間
- **行間**: 120–130%
- **段落間**: 文字サイズ × 0.5〜0.75

#### 日本語対応
- 約物の折り返しと2行省略（…）を標準
- ゴシック体（ヒラギノ角ゴ / SF Pro JP）

【MAT参照：デザイン定義 2.2.文字】

---

### 3.3 角丸・影・線

#### 角丸（Border Radius）
| トークン名 | 値（pt） | 用途 |
|---|---|---|
| Radius/Card | 12 | カード全般 |
| Radius/Chip | 10 | チップ（興味タグ・フィルタ） |
| Radius/Button | 10 | ボタン |
| Radius/Pill | 16 | ピル形状（バッジ・連続日数） |
| Radius/Thumbnail | 8 | サムネイル画像 |
| Radius/Avatar | 50% | アバター（円形） |

#### 影（Elevation）
| レベル | y offset | blur | opacity | 用途 |
|---|---|---|---|---|
| Elevation 0 | 0 | 0 | 0% | 無影（基本） |
| Elevation 1 | 2 | 4 | 10–12% | 強調カード |
| Elevation 2 | 4 | 8 | 15% | モーダル（ほぼ未使用、Material優先） |

※iOSでは影より Material（半透明・ぼかし）を優先

#### ボーダー
- **原則**: なし（余白とセマンティックカラーで区切り）
- **必要時**: `separator` を 1px（デバイスピクセル）で使用

【MAT参照：デザイン定義 2.3.角丸・影・線】

---

### 3.4 余白スケール（4ptグリッド）

| トークン名 | 値（pt） | 用途 |
|---|---|---|
| Spacing/XS | 4 | 極小（アイコンと文字の間） |
| Spacing/S | 8 | 小（要素間の密な間隔） |
| Spacing/M | 12 | 中（カード内の要素間） |
| Spacing/L | 16 | 大（画面左右のセーフマージン、カード外枠） |
| Spacing/XL | 24 | 特大（セクション間） |
| Spacing/XXL | 32 | 超特大（大きなセクション間） |

#### 使用例
- **カード内**: 外枠L=16、要素間S〜M、見出しと本文の間M
- **画面左右**: セーフマージン=16
- **セクション間**: XL=24

【MAT参照：デザイン定義 2.4.余白スケール】

---

## 4. コンポーネント仕様（Figma / SwiftUI用）

### 4.1 ナビゲーション

#### TopBar（Large Title）
- **左**: タイトル（Large Title 34pt Bold）
- **右**: 通知（`bell` + バッジドット）、検索（`magnifyingglass`）、アバター（円形24〜28pt）
- **スクロール時**: 小タイトルへ縮小（標準アニメーション 0.3s）
- **背景**: `systemMaterial`（半透明・ぼかし）

#### Tab Bar
- **高さ**: 49pt（システム標準）
- **アイコン**: SF Symbols（サイズ20〜22pt）
- **ラベル**: 11–12pt（各タブ下）
- **選択状態**:
  - 選択中: `systemBlue`（Accent/Primary） + filled
  - 未選択: `secondaryLabel`
- **例**:
  - ホーム: `house` / `house.fill`
  - コミュニティ: `person.2` / `person.2.fill`
  - 探索: `sparkles` / `sparkles`
  - マッチ: `heart.text.square` / `heart.text.square.fill`
  - プロフィール: `person.crop.circle` / `person.crop.circle.fill`

【MAT参照：デザイン定義 3.1 / 4.1】

---

### 4.2 セクションヘッダー

- **左**: タイトル（Title 2 22pt Semibold）
- **右**: 「すべて見る」（Body 17pt + `chevron.right`）
- **余白**:
  - 上: XL=24
  - 下: M=12
- **タップ領域**: 右側全体（高さ44pt以上）

【MAT参照：デザイン定義 4.2】

---

### 4.3 カード

#### ニュース/速報カード（縦型・強調）
- **レイアウト**:
  - サムネイル（16:9、上部）
  - タイトル（Headline 17pt、最大2行）
  - メタ情報（Footnote 13pt、時間 / バッジ）
- **角丸**: 12pt
- **内側余白**: L=16
- **背景**: `secondarySystemGroupedBackground`
- **バッジ**: 右上にピル（例: 🔥速報、新着）
  - 色: `systemOrange` / `systemRed`
  - コントラスト: AA以上

#### おすすめカード（横スクロール）
- **レイアウト**:
  - 左: サムネイル 48〜56pt（角丸8pt）
  - 右: タイトル（2行まで） + メタ（一致率 / 距離）
- **カード幅**: デバイス幅の75%
- **間隔**: M=12
- **スクロール**: 水平スナップ、慣性スクロール

#### スワイプカード（探索用）
- **比率**: 3:4（デバイス幅 − 32）
- **最大高さ**: 画面高さの60–65%
- **構成**:
  1. 写真スライド（最大5枚、ページネーションドット）
  2. 年齢帯・属性ピル（背景: `tertiarySystemFill`）
  3. 興味タグ（最大3つ、チップ形式）
  4. 自己紹介（最大2行、省略記号）
- **アクションボタン**:
  - 左下: 「スキップ」（`xmark.circle`、44×44pt）
  - 右下: 「興味あり」（`heart.circle.fill`、44×44pt）
- **影**: Elevation 1（y=2、不透明度10%）

【MAT参照：デザイン定義 4.3 / 4.5】

---

### 4.4 フィルタチップ

- **形状**: ピル（角丸16pt）
- **高さ**: 32pt
- **水平余白**: 12pt（左右）
- **垂直余白**: 6pt（上下）
- **フォント**: Callout 16pt
- **状態**:
  - **未選択**: 背景 `secondarySystemFill`、文字 `label`
  - **選択**: 背景 `systemBlue`（Accent）、文字 `white`
- **アニメ**: タップ時スケール0.95 → 1.0（スプリング damping 0.8）

【MAT参照：デザイン定義 4.4】

---

### 4.5 モーダル

#### 半モーダルシート（マッチ成立）
- **サイズ**: Medium（画面高さの50%）
- **背景**: `systemBackground`
- **上部**: 成功アニメ（スケール 1.0 → 1.1 → 1.0、0.5s）
- **構成**:
  1. タイトル（Title 2 22pt）: 「マッチしました！」
  2. 説明（Body 17pt）: 「Instagramでつながりますか？」
  3. IGハンドル（Headline 17pt、コピー可能）
  4. 主ボタン: 「Instagramを開く」（Primary CTA）
  5. 副ボタン: 「あとで」（Secondary）
  6. 注意文（Footnote 13pt）: 「外部アプリへ移動します」
- **ジェスチャ**: 下スワイプで閉じる
- **ハプティクス**: `notificationSuccess`

【MAT参照：デザイン定義 4.6】

---

## 5. インタラクション & モーション

### 5.1 タップフィードバック

- **標準ボタン**: 100–150ms フェード + スケール0.98 → 1.0
- **ハプティクス**: `impactLight`

### 5.2 スワイプカード

- **タッチ開始**: カードが指に追従（水平移動 + わずかな角度回転）
- **背景色ヒント**:
  - 左移動 → 薄い赤（スキップ）
  - 右移動 → 薄い緑（興味あり）
- **閾値到達（80pt）**: 色が濃くなる、`impactLight`
- **完了**:
  - 閾値超過 → スプリング（damping 0.85）で画面外へ飛び出し
  - 閾値未満 → スプリングで元位置へ戻る
- **次カード**: 下から上へスライドイン（0.3s）

### 5.3 遷移

- **プッシュ/ポップ**: 標準アニメーション（0.3s）
- **モーダル**: 下から上へスライドイン（0.4s）
- **トースト**: 上から下へスライドイン（0.3s）、フェードアウト（0.2s）

### 5.4 プル・トゥ・リフレッシュ

- **標準コントロール**: システム標準インジケータ
- **色**: `secondaryLabel`

### 5.5 スケルトン

- **形状**: カード形状のプレースホルダ（角丸12pt）
- **アニメ**: 上下にシマー（グラデーション移動、1.5s無限ループ）

### 5.6 ハプティクス

| アクション | フィードバック |
|---|---|
| マッチ成立 | `notificationSuccess` |
| エラー発生 | `notificationError` |
| 興味あり確定 | `impactLight` |
| ブロック | `impactRigid` |
| タップ（軽操作） | `impactLight` |

【MAT参照：デザイン定義 5.インタラクション】

---

## 6. アクセシビリティ

### 6.1 タップ領域
- **最小サイズ**: 44×44pt（すべてのインタラクティブ要素）
- **例外**: リスト内のセル（高さ60pt以上）

### 6.2 Dynamic Type
- **対応**: すべてのテキストがユーザー設定に追随
- **制約**: 重要CTAは2行まで（3行目以降は省略記号）
- **レイアウト**: 文字サイズ最大時もボタンが折り返さず、タップ可能

### 6.3 VoiceOver
- **ラベル**: すべてのボタン・画像に日本語ラベル設定
- **ヒント**: 複雑な操作（スワイプカード）にヒントテキスト
  - 例: 「左スワイプでスキップ、右スワイプで興味ありを送信します」
- **グループ化**: カード内要素を1つのグループとして読み上げ

### 6.4 コントラスト
- **主要文言**: 最小AA（4.5:1）
- **重要ボタン**: AA Large（3:1）以上
- **検証**: LightモードとDarkモードの両方で測定

### 6.5 モーション軽減
- **Reduce Motion有効時**:
  - パララックス無効化
  - スプリングアニメを線形に弱化（duration 0.2s）
  - スケール効果を削減（0.98 → 1.0のみ）

【MAT参照：デザイン定義 6.アクセシビリティ / 13.アクセシビリティ】

---

## 7. 状態設計

### 7.1 空状態（Empty State）
- **レイアウト**:
  1. アイコン（SF Symbol 48×48pt、`secondaryLabel`）
  2. 見出し（Headline 17pt）
  3. 説明（Body 17pt、`secondaryLabel`）
  4. CTAボタン（任意）
- **垂直中央**: セーフエリア内で中央配置
- **水平余白**: 32pt

### 7.2 ローディング
- **初回**: スケルトン（プレースホルダ + シマー）
- **追加**: リスト下部にスピナー（`UIActivityIndicatorView`）
- **プルリフレッシュ**: 標準コントロール

### 7.3 エラー
- **軽微**: 画面上部バナー（`systemRed` 10%背景）+ 再試行ボタン
- **致命的**: フル画面（アイコン + タイトル + 説明 + 再試行ボタン）
- **オフライン**: 画面上部バナー（`systemGray` 10%背景）+ キャッシュデータ表示

【MAT参照：デザイン定義 7.状態設計】

---

## 8. アイコングラフィ（SF Symbols推奨）

| 用途 | Symbol名 |
|---|---|
| 通知 | `bell` / `bell.fill` |
| 検索 | `magnifyingglass` |
| プロフィール | `person.crop.circle` / `person.crop.circle.fill` |
| コミュニティ | `person.2` / `person.2.fill` |
| 探索 | `sparkles` |
| マッチ | `heart.text.square` / `heart.text.square.fill` |
| 報告 | `exclamationmark.bubble` |
| ブロック | `nosign` |
| 位置 | `mappin.and.ellipse` |
| スキップ | `xmark.circle` |
| 興味あり | `heart.circle.fill` |
| エラー | `exclamationmark.triangle` |

【MAT参照：デザイン定義 10.アイコングラフィ】

---

## 9. 文言トーン（日本語）

### 9.1 基本トーン
- **丁寧だがフレンドリー**: 「しましょう」「できます」を基本
- **押し付けない**: 「〜してください」より「〜してみませんか？」
- **健全性強調**: 「友達」「仲間」「コミュニティ」を多用

### 9.2 確認ダイアログ
- 具体的: 「Instagramを開きます。よろしいですか？」
- 押し付けない: 「削除すると復元できません。本当によろしいですか？」

【MAT参照：デザイン定義 9.文言トーン / 12.文言ポリシー】

---

## 10. 品質ゲート（UI観点の受け入れ条件）

### 10.1 視覚的整合性
- [ ] ライト/ダークで色ズレ・可読性低下がない
- [ ] すべてのカード・ボタンの角丸が仕様通り（8 / 10 / 12 / 16pt）
- [ ] 影は最小限（基本Elevation 0、強調のみElevation 1）

### 10.2 インタラクション
- [ ] スワイプカードの閾値（80pt）で確定アニメ発火
- [ ] タップ時のハプティクスが正常動作（成功 / エラー / 軽操作）
- [ ] プルリフレッシュで最新データ取得

### 10.3 アクセシビリティ
- [ ] VoiceOverですべての要素が読み上げられる
- [ ] タップ領域が44×44pt以上（実機検証）
- [ ] コントラストチェッカーでAA以上（主要文言）

### 10.4 状態遷移
- [ ] Empty状態でCTAボタンが表示される
- [ ] Loading中にスケルトンが表示される
- [ ] Error時に再試行ボタンが機能する

### 10.5 パフォーマンス
- [ ] スクロール時のLarge Title縮小が滑らか（60fps）
- [ ] カードのスワイプアニメがカクつかない（実機60fps）
- [ ] 画像未取得時でも骨組みが破綻しない

【MAT参照：デザイン定義 12.品質ゲート】

---

## 11. Plan-MD 参照マップ

| 本文書セクション | Plan-MD 参照箇所 |
|---|---|---|
| 1. 目的 | デザイン定義全般 |
| 2. デザイン原則 | デザイン定義 1.デザイン原則 |
| 3. ビジュアル基調 | デザイン定義 2.ビジュアル基調 |
| 4. コンポーネント | デザイン定義 4.コンポーネント仕様 |
| 5. インタラクション | デザイン定義 5.インタラクション & モーション |
| 6. アクセシビリティ | デザイン定義 6.アクセシビリティ、13.アクセシビリティ |
| 7. 状態設計 | デザイン定義 7.状態設計 |
| 8. アイコングラフィ | デザイン定義 10.アイコングラフィ |
| 9. 文言トーン | デザイン定義 9.文言トーン、12.文言ポリシー |
| 10. 品質ゲート | デザイン定義 12.品質ゲート |

---

## 12. 補足

### 12.1 Figma推奨構成
- **Primitives**: Color Tokens / Text Styles / Spacing / Elevation / Radius
- **Atoms**: Icon（SF）、Button（Primary/Secondary/Tertiary/Destructive）、Badge、Chip、Avatar
- **Molecules**: SectionHeader、ListCell、Card（Vertical/Horizontal）、SwipeCard、SearchBar
- **Organisms**: HomeHero、HorizontalCarousel、CommunityGrid、MatchSheet
- **Templates**: Home / Explore / Community / Match / Profile / Settings
- **Page**: Light/Darkガイド、アクセシビリティ検証フレーム（Dynamic Type）

### 12.2 更新履歴
| 日付 | 変更内容 | 担当 |
|---|---|---|
| 2025-10-20 | 初版作成 | デザイン |

---

**次に読むべき文書**: `0.6_情報設計_データモデル.md`（データ構造詳細）
