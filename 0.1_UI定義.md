# 0.1 UI定義

## 文書情報
- **作成日**: 2025-10-20
- **対象**: Tokyo Friends iOS App (仮称)
- **バージョン**: v1.0 (MVP)
- **想定プラットフォーム**: iOS 16以上（推奨：iOS 17+）

---

## 1. 目的

本文書は、iOSアプリケーションにおける**すべてのUIコンポーネント**の視覚的・構造的仕様を定義し、開発・デザイン・QA間で整合性を担保することを目的とします。

### 狙い
- Appleの Human Interface Guidelines（HIG）に準拠し、iOSプラットフォームに自然に溶け込む体験を提供する
- 「友達づくり」の健全性を視覚的に支えるトーン&マナーを確立する
- 開発者が迷わずコンポーネントを実装できる具体的な数値・名称を規定する

【MAT参照：1.プロダクト概要 / 6.1.フレームワーク / デザイン定義全般】

---

## 2. UI原則

### 2.1 Apple哲学の反映
1. **Content First（内容優先）**: 装飾より情報階層を明確化し、余白を多めに取る
2. **Clarity（明瞭さ）**: 1画面＝1主目的。視線誘導は「大見出し → セクション見出し → カード」の3段階
3. **Depth（奥行き）**: 半透明・ブラー（Material）と柔らかな影を最小限で活用
4. **Consistency（一貫性）**: SF Symbols・Semantic Colors・Dynamic Type・標準ナビゲーション要素を優先
5. **Direct Manipulation（直接操作）**: スワイプ・プルリフレッシュ等の標準ジェスチャを尊重

【MAT参照：デザイン定義 1.デザイン原則】

### 2.2 本アプリ固有の価値
- **顔出し任意を尊重**: 写真ゼロでも体験が破綻しない設計
- **安全性を1タップで**: ブロック／通報／非表示を常に手の届く位置に配置
- **恋愛文脈の排除**: 文言・アイコン・色調で「友達づくり」「コミュニティ参加」を強調

【MAT参照：3.体験原則 / 21.付録：UIコピー指針】

---

## 3. UIコンポーネント仕様

### 3.1 グローバルナビゲーション

#### 3.1.1 タブバー（Tab Bar）
**目的**: アプリの最上位カテゴリへ即座にアクセス

- **位置**: 画面最下部（Safe Area内）
- **高さ**: 49pt（システム標準）
- **タブ数**: 5つ
  1. **ホーム**: `house` (SF Symbol)
  2. **コミュニティ**: `person.2`
  3. **探索**: `sparkles`
  4. **マッチ**: `heart.text.square`
  5. **プロフィール**: `person.crop.circle`
- **選択状態**:
  - 選択中: `systemBlue`（またはブランドAccent色）+ アイコンfilled
  - 未選択: `secondaryLabel`
- **ラベル**: 11–12pt、各タブ下に日本語ラベル
- **アクセシビリティ**: タップ領域は44×44pt以上、VoiceOverラベル設定必須

【MAT参照：デザイン定義 3.1.全体構造 / 4.1.ナビゲーション】

#### 3.1.2 ナビゲーションバー（Navigation Bar）
**目的**: 現在画面のタイトルと補助操作の提供

- **タイトル表示**: Large Title（34pt Bold）
  - スクロールで小タイトル（17pt Semibold）へ縮小
- **右側アクション** (最大3つ):
  - 通知: `bell` + バッジドット（未読時）
  - 検索: `magnifyingglass`
  - アバター: 円形24〜28pt（プロフィール画面への導線）
- **背景**: `systemMaterial`（半透明・ぼかし）
- **戻るボタン**: システム標準（前画面タイトル or 「戻る」）

【MAT参照：デザイン定義 3.1 / 4.1 / ページ定義 0.グローバル前提】

---

### 3.2 カード系コンポーネント

#### 3.2.1 探索カード（スワイプカード）
**目的**: 友達候補を1枚ずつ判断する主要UI

- **比率**: 3:4（デバイス幅 − 32pt）
- **最大高さ**: 画面高さの60–65%
- **構成要素**:
  1. **写真スライド**: 最大5枚、下部にページネーションドット
  2. **年齢帯・属性ピル**: 例「20–22歳 / 学生」（背景: `tertiarySystemFill`）
  3. **興味タグ**: 最大3つ（チップ形式、10pt角丸）
  4. **自己紹介**: 最大2行（省略記号で切り詰め）
- **アクション**:
  - 左下: 「スキップ」ボタン（44×44pt）`xmark.circle`
  - 右下: 「興味あり」ボタン（44×44pt）`heart.circle.fill`
- **ジェスチャ**:
  - 左スワイプ → スキップ（閾値: 80pt、アニメーション: スプリングで左へ飛び出し）
  - 右スワイプ → 興味あり（閾値: 80pt、アニメーション: スプリングで右へ飛び出し）
  - 長押し → プロフィール詳細（PG-31）へ遷移
- **影**: Elevation 1（y=2、不透明度10%）
- **角丸**: 12pt

**状態**:
- **Empty**: 「参加しているコミュニティで候補がいません。新しいコミュニティに参加してみましょう」+ CTA
- **Loading**: スケルトン（プレースホルダ + シマーアニメ）
- **Error**: 「読み込みに失敗しました」バナー + 再試行ボタン

【MAT参照：4.4.カード探索 / デザイン定義 4.3.カード / 4.5.スワイプカード / ページ定義 PG-30】

#### 3.2.2 ニュース/速報カード（縦型・強調）
**目的**: ホーム画面で注目情報を1件強調表示

- **レイアウト**:
  - サムネイル（16:9、上部）
  - タイトル（Headline 17pt、最大2行）
  - メタ情報（Footnote 13pt、時間 / バッジ）
- **角丸**: 12pt
- **内側余白**: 16pt
- **背景**: `secondarySystemGroupedBackground`
- **バッジ**: 右上にピル形状（例：「🔥速報」「新着」）
  - 色: `systemOrange`（Warning）/ `systemRed`（Danger）
  - コントラスト: AA以上

【MAT参照：デザイン定義 3.2.ホーム / 4.3.カード】

#### 3.2.3 おすすめカード（横スクロール）
**目的**: コミュニティ・友達候補を横並びで提示

- **レイアウト**:
  - 左: サムネイル 48〜56pt（角丸8pt）
  - 右: タイトル（2行まで）+ メタ（一致率 / 距離）
- **カード幅**: デバイス幅の75%
- **間隔**: 12pt（M）
- **スクロール**: 水平スナップ（Paging無効、慣性スクロール）
- **背景**: `secondarySystemGroupedBackground`

【MAT参照：デザイン定義 3.2.ホーム / 4.3.カード】

---

### 3.3 入力系コンポーネント

#### 3.3.1 テキストフィールド
**目的**: 電話番号・学校名・自己紹介等のテキスト入力

- **高さ**: 44pt（最小タップ領域）
- **角丸**: 8pt
- **背景**: `secondarySystemBackground`
- **ボーダー**: 通常時なし、フォーカス時に `systemBlue` 1pt
- **プレースホルダ**: `tertiaryLabel`
- **入力文字**: `label`、Body 17pt
- **エラー状態**:
  - ボーダー: `systemRed`
  - 下部にエラーメッセージ（Footnote 13pt、`systemRed`）

【MAT参照：4.1.会員登録 / 4.2.オンボーディング / ページ定義 PG-02〜08】

#### 3.3.2 チップ選択（興味タグ・フィルタ）
**目的**: 複数選択可能なタグ群

- **形状**: ピル（角丸16pt）
- **高さ**: 32pt
- **水平余白**: 12pt（左右）
- **垂直余白**: 6pt（上下）
- **フォント**: Callout 16pt
- **状態**:
  - **未選択**: 背景 `secondarySystemFill`、文字 `label`
  - **選択**: 背景 `systemBlue`（Accent）、文字 `white`（高コントラスト）
- **アニメ**: タップ時スケール0.95 → 1.0（スプリング）

【MAT参照：4.2.オンボーディング / デザイン定義 4.4.フィルタチップ / ページ定義 PG-06】

#### 3.3.3 DatePicker（生年月日）
**目的**: 年齢確認用の日付入力

- **スタイル**: Wheels（iOS標準ピッカー）
- **範囲**: 18歳以上のみ選択可能（最大年齢: 100歳）
- **初期値**: 現在から18年前
- **検証**: ローカル時刻依存なし、UTC基準で満18歳判定

【MAT参照：4.1.会員登録 / ページ定義 PG-03】

---

### 3.4 フィードバック系コンポーネント

#### 3.4.1 トースト（成功・エラー通知）
**目的**: 一時的なフィードバック表示

- **位置**: 画面上部（Safe Area下）またはタブバー上部
- **高さ**: 48pt
- **背景**:
  - 成功: `systemGreen` 10%不透明度 + `systemGreen` アイコン
  - エラー: `systemRed` 10%不透明度 + `systemRed` アイコン
  - 情報: `systemBlue` 10%不透明度
- **表示時間**: 3秒（自動非表示）
- **アニメ**: 下から上へスライドイン（0.3s）、フェードアウト（0.2s）
- **ハプティクス**:
  - 成功: `notificationSuccess`
  - エラー: `notificationError`

【MAT参照：4.6.安全 / ページ定義 PG-61 / デザイン定義 5.インタラクション】

#### 3.4.2 プログレスインジケータ
**目的**: 処理中を視覚的に伝達

- **種類**:
  1. **スピナー**: システム標準（`UIActivityIndicatorView`）、画面中央配置
  2. **スケルトン**: カード形状のプレースホルダ（角丸 + シマーアニメ）
  3. **プルリフレッシュ**: 標準コントロール（下に引いて更新）
- **色**: `secondaryLabel`（スピナー）
- **タイムアウト**: 3秒で再試行ボタン表示

【MAT参照：デザイン定義 5.インタラクション / 7.状態設計 / 15.エラー/オフライン】

#### 3.4.3 バッジドット（通知インジケータ）
**目的**: 未読通知の存在を示す

- **サイズ**: 8×8pt（円形）
- **色**: `systemRed`
- **位置**: アイコン右上隅（重なり4pt）
- **数値**: 1〜99（100以上は「99+」）

【MAT参照：デザイン定義 4.1.ナビゲーション / ページ定義 PG-50】

---

### 3.5 モーダル系コンポーネント

#### 3.5.1 半モーダルシート（マッチ成立）
**目的**: 重要な成功体験を即座に伝達

- **サイズ**: Medium（画面高さの50%）
- **背景**: `systemBackground`
- **上部**: 成功アニメ（スケール1.0 → 1.1 → 1.0、0.5s）
- **構成**:
  1. タイトル（Title 2 22pt）: 「マッチしました！」
  2. 説明（Body 17pt）: 「Instagramでつながりますか？」
  3. 相手のIGハンドル（Headline 17pt、コピー可能）
  4. 主ボタン: 「Instagramを開く」（Primary CTA）
  5. 副ボタン: 「あとで」（Secondary）
  6. 注意文（Footnote 13pt）: 「外部アプリへ移動します」
- **ジェスチャ**: 下スワイプで閉じる
- **ハプティクス**: `notificationSuccess`

【MAT参照：4.5.マッチング / デザイン定義 4.6.マッチモーダル / ページ定義 PG-32】

#### 3.5.2 確認ダイアログ（アラート）
**目的**: 破壊的操作の確認

- **種類**:
  - アカウント削除: 「削除すると復元できません。本当によろしいですか?」
  - ブロック: 「このユーザーをブロックしますか？」
  - 外部遷移: 「Instagramを開きます。よろしいですか？」
- **ボタン数**: 2つ（主・副）
- **スタイル**:
  - 破壊的: `destructive`（赤文字）
  - 通常: `default`
  - キャンセル: `cancel`（太字）

【MAT参照：4.5.マッチング / 4.6.安全 / ページ定義 PG-63】

---

### 3.6 セクション系コンポーネント

#### 3.6.1 セクションヘッダー
**目的**: コンテンツ群の見出しと全体表示への導線

- **レイアウト**:
  - 左: タイトル（Title 2 22pt Semibold）
  - 右: 「すべて見る」（Body 17pt + `chevron.right`）
- **余白**:
  - 上: 24pt（XL）
  - 下: 12pt（M）
- **タップ領域**: 右側全体（44pt高さ）

【MAT参照：デザイン定義 4.2.セクションヘッダー / ページ定義 PG-10】

#### 3.6.2 空状態（Empty State）
**目的**: コンテンツ不在時の案内と次アクション

- **レイアウト**:
  1. アイコン（SF Symbol 48×48pt、`secondaryLabel`）
  2. 見出し（Headline 17pt）: 例「まだマッチがありません」
  3. 説明（Body 17pt、`secondaryLabel`）: 次の行動を1つ提示
  4. CTAボタン（任意）: 例「コミュニティに参加する」
- **垂直中央**: セーフエリア内で中央配置
- **水平余白**: 32pt

【MAT参照：デザイン定義 7.状態設計 / ページ定義 PG-33】

---

## 4. 状態別UI仕様

### 4.1 Empty（空状態）
- **表示条件**: データが0件、または検索結果なし
- **UI要素**:
  - アイコン（SF Symbol）
  - 見出し（Headline）
  - 説明文（Body、1〜2行）
  - CTAボタン（任意）
- **例**:
  - 探索カード在庫切れ: 「新しいコミュニティに参加すると、友達候補が増えます」 + 「コミュニティを探す」ボタン
  - マッチ0件: 「まだマッチがありません」 + 「探索を始める」ボタン

### 4.2 Loading（読み込み中）
- **初回読み込み**: スケルトン（カード形状のプレースホルダ + シマーアニメ）
- **追加読み込み**: リスト下部にスピナー（`UIActivityIndicatorView`）
- **プルリフレッシュ**: 標準コントロール（上から引いて更新）
- **タイムアウト**: 3秒で「読み込みに失敗しました」バナー + 再試行ボタン

### 4.3 Error（エラー）
- **軽微なエラー**: 画面上部バナー（`systemRed` 10%背景）+ 再試行ボタン
- **致命的エラー**: フル画面
  - アイコン（`exclamationmark.triangle`）
  - タイトル（Title 2）: 「エラーが発生しました」
  - 説明（Body）: 具体的な原因と対処法
  - 再試行ボタン
- **オフライン**: 「インターネット接続を確認してください」+ キャッシュデータ表示（グレーアウト）

【MAT参照：15.エラー/オフライン設計 / デザイン定義 7.状態設計 / ページ定義 PG-90】

---

## 5. アクセシビリティ要件

### 5.1 タップ領域
- **最小サイズ**: 44×44pt（すべてのインタラクティブ要素）
- **例外**: リスト内のセル（高さ60pt以上）

### 5.2 Dynamic Type
- **対応**: すべてのテキストがユーザー設定に追随
- **制約**: 重要CTAは2行まで（3行目以降は省略記号）
- **レイアウト**: 文字サイズ最大時もボタンが折り返さず、タップ可能

### 5.3 VoiceOver
- **ラベル**: すべてのボタン・画像に日本語ラベル設定
- **ヒント**: 複雑な操作（スワイプカード）にヒントテキスト追加
  - 例: 「左スワイプでスキップ、右スワイプで興味ありを送信します」
- **グループ化**: カード内要素を1つのグループとして読み上げ
  - 例: 「田中太郎、20〜22歳、学生、興味: カフェ・サウナ・写真。興味ありボタン、スキップボタン」

### 5.4 コントラスト
- **主要文言**: 最小AA（4.5:1）
- **重要ボタン**: AA Large（3:1）以上
- **検証**: LightモードとDarkモードの両方で測定

### 5.5 モーション軽減
- **Reduce Motion有効時**:
  - パララックス無効化
  - スプリングアニメを線形に弱化（duration 0.2s）
  - スケール効果を削減（0.98 → 1.0のみ）

【MAT参照：13.アクセシビリティ/ローカライズ / デザイン定義 6.アクセシビリティ / ページ定義 付録B】

---

## 6. 計測・ログ

### 6.1 UIインタラクション計測
以下の操作を匿名ID・タイムスタンプ付きでロギング:

- **ボタンタップ**: `tap_{button_name}` (例: `tap_like_btn`, `tap_skip_btn`)
- **スワイプ**: `swipe_like`, `swipe_skip`
- **画面表示**: `{screen_name}_view` (例: `home_view`, `explore_view`)
- **エラー表示**: `error_view` + エラー種別
- **モーダル表示**: `match_sheet_view`, `profile_modal_view`

### 6.2 送信禁止データ
- IGハンドル、電話番号等のPII
- 位置情報の生データ（区・駅名のみ許可）

【MAT参照：14.分析/ログ / ページ定義 付録A】

---

## 7. 受け入れ基準（AC）

### 7.1 視覚的整合性
- [ ] LightモードとDarkモードで色ズレがない
- [ ] Dynamic Type（最小〜最大）で主要CTAが折り返さない
- [ ] すべてのカード・ボタンの角丸が仕様通り（8pt / 10pt / 12pt / 16pt）

### 7.2 インタラクション
- [ ] スワイプカードの閾値（80pt）を超えると確定アニメが発火
- [ ] タップ時のハプティクスが正常動作（成功 / エラー / 軽い操作）
- [ ] プルリフレッシュで最新データが取得される

### 7.3 アクセシビリティ
- [ ] VoiceOverですべての要素が読み上げられる
- [ ] タップ領域が44×44pt以上（実機で検証）
- [ ] コントラストチェッカーでAA以上（主要文言）

### 7.4 状態遷移
- [ ] Empty状態でCTAボタンが表示される
- [ ] Loading中にスケルトンが表示される
- [ ] Error時に再試行ボタンが機能する
- [ ] オフライン時にキャッシュデータがグレーアウトで表示される

### 7.5 パフォーマンス
- [ ] スクロール時のLarge Title縮小が滑らか（60fps）
- [ ] カードのスワイプアニメがカクつかない（実機60fps）
- [ ] 画像未取得時でも骨組みが破綻しない

【MAT参照：16.QA/受け入れテスト / デザイン定義 12.品質ゲート】

---

## 8. Plan-MD 参照マップ

| 本文書セクション | Plan-MD 参照箇所 |
|---|---|
| 1. 目的 | 1. プロダクト概要 |
| 2. UI原則 | 3. 体験原則、デザイン定義 1.デザイン原則 |
| 3.1 グローバルナビ | デザイン定義 3.1 / 4.1、ページ定義 0.グローバル前提 |
| 3.2 カード系 | 4.4. カード探索、デザイン定義 4.3 / 4.5、ページ定義 PG-30 |
| 3.3 入力系 | 4.1 / 4.2、ページ定義 PG-02〜08 |
| 3.4 フィードバック系 | デザイン定義 5. インタラクション、15. エラー/オフライン |
| 3.5 モーダル系 | 4.5. マッチング、デザイン定義 4.6、ページ定義 PG-32 |
| 4. 状態別UI | デザイン定義 7. 状態設計、ページ定義 PG-90 |
| 5. アクセシビリティ | 13. アクセシビリティ、デザイン定義 6、ページ定義 付録B |
| 6. 計測・ログ | 14. 分析/ログ、ページ定義 付録A |
| 7. 受け入れ基準 | 16. QA/受け入れテスト、デザイン定義 12 |

---

## 9. 補足

### 9.1 コンポーネント命名規則（Figma / SwiftUI）
- **Primitives（基礎）**: `Color/Primary`, `Spacing/M`, `Radius/Card`
- **Atoms（原子）**: `Button/Primary`, `Icon/Bell`, `Badge/Dot`
- **Molecules（分子）**: `SectionHeader`, `ListCell`, `Card/Vertical`
- **Organisms（生体）**: `HomeHero`, `SwipeDeck`, `MatchSheet`

### 9.2 更新履歴
| 日付 | 変更内容 | 担当 |
|---|---|---|
| 2025-10-20 | 初版作成 | デザイン・開発 |

---

**次に読むべき文書**: `0.2_UX定義.md`（ユーザー体験フロー）
